<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Riot API Site</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    <script>
    var requestUrlList = {
      summonerByName:"https://euw1.api.riotgames.com/lol/summoner/v4/summoners/by-name/",
      leagueByID:"https://euw1.api.riotgames.com/lol/league/v4/entries/by-summoner/",
      theEnd:"?api_key=",
    };
    var URLType;
    var summonerNameType;
    var BasicSummonerInfo;
    var summonerRankInfos;
    var codeFileName="../Stuff/riotAPIcode.txt"
    //Variable apikey has content of codeFileName
    var apikey=readTextFile(codeFileName)
    //When any Button pressed
    function reply_click(clicked_id){

      //Button pressed Level or Rank
      if (clicked_id == "summonerInfo" ) {
          URLType="summonerByName"
          summonerNameType=document.getElementById('inputField').value
          //Basic Summoner Infos
          leagueRequest(getCompleteRequestUrl(summonerNameType,URLType,apikey),function(returnData){
            BasicSummonerInfo=returnData;
            alert(BasicSummonerInfo["summonerLevel"])

            //summonerRankInfos
            URLType="leagueByID"
            summonerNameType=BasicSummonerInfo["id"]
            leagueRequest(getCompleteRequestUrl(summonerNameType,URLType,apikey),function(returnData){
              summonerRankInfos=returnData;
              alert(summonerRankInfos["0"]["tier"])
            });
          });
      }
      //testButton
      else if (clicked_id == "testButton") {
        testAlert(apikey);
      }
    };
    function leagueRequest(completeRequestUrl,returnData){
      //completeRequestUrl URL+Key
      //returnData to return Data because of asynchronous ajax
      $.ajax({
          url: completeRequestUrl,
          type: 'GET',
          dataType: 'json',
          success: function(data) {
            //return json string parsed into object
            returnData(eval(data));
          },
          error: function() { alert('boo!'); },
          beforeSend: setHeader
      });
    }
    function setHeader(xhr) {
        xhr.setRequestHeader('securityCode', 'Foo');
        xhr.setRequestHeader('passkey', 'Bar');
    }
    function testAlert(message) {
      alert(message);
    }
    function readTextFile(file) {
      var rawFile = new XMLHttpRequest();
      rawFile.open("GET", file, false);
      rawFile.send(null);
      return rawFile.responseText;
    }
    function getCompleteRequestUrl(summonerData,requestUrlName,apikey){
      if(requestUrlName=="summonerByName"){
        summonerData=encodeURI(summonerData);
      }
      //combine URL with (Encoded Summonername) or other + API KEY "header" + API Key
      var CompleteRequestUrl=requestUrlList[requestUrlName].concat(summonerData.concat(requestUrlList["theEnd"].concat(apikey)));
      return CompleteRequestUrl;
    }
    </script>


  </head>
  <body>
    <button id="summonerInfo" onClick="reply_click(this.id)">Get Summoner Infos</button><br>
    <button id="testButton" onClick="reply_click(this.id)">TestButton</button><br>
    Summoner Name: <input id="inputField" type="text" value=""><br>
  </body>
</html>
